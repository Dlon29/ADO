IF(@Identifier = 'SWIFT')
BEGIN			
    -- Insert all records into SettlementSwiftMsg with the filter for Toe in ('OSL', 'CSD') and also handle other conditions
    INSERT INTO dbo.SettlementSwiftMsg
    (
        SettlementStatusHeaderID,
        SwiftMsgID,
        ModifiedBy,
        ModifiedDate
    )
    SELECT DISTINCT
        @SettlementStatusHeaderID,
        swift.Items,
        @ModifiedBy,
        GETDATE()
    FROM
        dbo.f_Split(@SwiftMsgID, ',') swift
    INNER JOIN OPENXML(@hdoc, '/Txnlist/FieldName', 1)
    WITH
    (
        BGNREF VARCHAR(12),
        Toe VARCHAR(3)  -- Assuming Toe is a field inside the XML
    ) AS XmlData
    WHERE 
        XmlData.Toe IN ('OSL', 'CSD')  -- Filter for Toe in ('OSL', 'CSD')
    
    -- Also insert the rest of the BGNREFs that do not have Toe in ('OSL', 'CSD')
    UNION
    SELECT DISTINCT
        @SettlementStatusHeaderID,
        swift.Items,
        @ModifiedBy,
        GETDATE()
    FROM
        dbo.f_Split(@SwiftMsgID, ',') swift
    INNER JOIN OPENXML(@hdoc, '/Txnlist/FieldName', 1)
    WITH
    (
        BGNREF VARCHAR(12),
        Toe VARCHAR(3)  -- Assuming Toe is a field inside the XML
    ) AS XmlData
    WHERE 
        XmlData.Toe NOT IN ('OSL', 'CSD')  -- Insert records with Toe not in ('OSL', 'CSD')
END
