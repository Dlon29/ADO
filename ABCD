foreach (var tag in textBlock)
{
    ModifyTagValue(tag, "23G", "MODF");
}


private void ModifyTagValue(MTTag tag, string targetTag, string newValue)
{
    foreach (var child in tag.Body)
    {
        if (child.Tag == targetTag)
        {
            Console.WriteLine($"Modified tag {targetTag} from {child.Value} to {newValue}");
            child.Value = newValue;
        }
    }

    // Recursively check inner bodies (if any)
    foreach (var child in tag.Body)
    {
        if (child.Body.Any())
            ModifyTagValue(child, targetTag, newValue);
    }
}


List<string> updatedTagList = new List<string>();
foreach (var tag in textBlock)
{
    updatedTagList.AddRange(FlattenTagHierarchy(tag));
}


private List<string> FlattenTagHierarchy(MTTag tag)
{
    List<string> result = new List<string>();
    result.Add($":{tag.Tag}:{tag.Value}");

    foreach (var child in tag.Body)
    {
        result.AddRange(FlattenTagHierarchy(child));
    }

    return result;
}


string updatedBlock4 = string.Join("\r\n", updatedTagList);
Console.WriteLine("\nUpdated Block 4:\n" + updatedBlock4);
