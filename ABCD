IF(@Identifier = 'SWIFT')
BEGIN			
    
    INSERT INTO dbo.SettlementSwiftMsg
    (
        SettlementStatusHeaderID,
        SwiftMsgID,
        ModifiedBy,
        ModifiedDate
    )
    SELECT
        @SettlementStatusHeaderID,
        swift.Items,
        @ModifiedBy,
        GETDATE()
    FROM
        dbo.f_Split(@SwiftMsgID, ',') swift
    INNER JOIN OPENXML(@hdoc, '/Txnlist/FieldName', 1)
    WITH
    (
        BGNREF VARCHAR(12),
        Toe VARCHAR(3)  
    ) AS XmlData
    WHERE 
        XmlData.Toe IN ('OSL', 'CSD')  
    GROUP BY
        swift.Items  
  
   
    INSERT INTO dbo.SettlementSwiftMsg
    (
        SettlementStatusHeaderID,
        SwiftMsgID,
        ModifiedBy,
        ModifiedDate
    )
    SELECT
        @SettlementStatusHeaderID,
        swift.Items,
        @ModifiedBy,
        GETDATE()
    FROM
        dbo.f_Split(@SwiftMsgID, ',') swift
    INNER JOIN OPENXML(@hdoc, '/Txnlist/FieldName', 1)
    WITH
    (
        BGNREF VARCHAR(12),
        Toe VARCHAR(3)  
    ) AS XmlData
    WHERE 
        XmlData.Toe NOT IN ('OSL', 'CSD') 
END
