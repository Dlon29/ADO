public static DataSet GetSwiftTagComponentData(string applicationDBName)
{
    try
    {
        using (SqlConnection connection = SqlConnections.AppliCationDBConnection(applicationDBName))
        {
            SqlParameter[] parameters = new SqlParameter[0];
            return StoredProcSql.ExecuteDataSet(connection, ConstantsDAL.SPNAME_GETSWIFTTAGCOMPONENTDATA, parameters);
        }
    }
    catch (Exception ex)
    {

        _logger.LogErrorMessage(applicationDBName,"Error in method GetSwiftTagComponentData", ex, true,
                               MethodBase.GetCurrentMethod().Name, new string[] { "applicationDBName", "Stored Procedure" }, applicationDBName, ConstantsDAL.SPNAME_GETSWIFTTAGCOMPONENTDATA);

        throw;
    }
}




public static DataSet GetSwiftTagComponentData(string applicationDBName)
{
    try
    {
        DataSet ds = SwiftInboundDAL.GetSwiftTagComponentData(applicationDBName);

        if (ds != null)
        {
            ds.Tables[0].TableName = "SwiftTagComponent";
        }

        return ds;

    }
    catch (Exception)
    {

        throw;
    }

}


private void ProcessEachCouriers(FtpConfigurationElement item)
{
    string tagCompData = String.Empty;

    try
    {
        _logger.LogInfoFormat(item.DBName + " - " + item.MessageTypes, Constants.CONS_STARTEXECUTING_SwiftTagComponentData, MethodBase.GetCurrentMethod().Name, MethodBase.GetCurrentMethod().DeclaringType.Name);
       
        DataSet dsResult = SWIFTInbound.GetSwiftTagComponentData(item.DBName);
        tagCompData = Common.Common.ConvertObjectToXMLString(dsResult.Tables[0]);

        courier.Read(tagCompData, item);
    }
    catch (Exception ex)
    {
        _logger.LogErrorMessage(item.DBName + " - " + item.MessageTypes, Constants.CONS_INBOUND_COURIER_MESSAGE_ERROR, ex, true,
                                Constants.CONS_METHOD_PROCESSEACHCOURIERS, new string[] {"DBName", "tagCompData"}, item.DBName, tagCompData);
    }
}


public void Read(string tagCompData, FtpConfigurationElement item)
{
    this.ReadSwiftMessages(tagCompData, item);
}



public override List<string> ReadSwiftMessages(string tagCompData, FtpConfigurationElement item)
{
    List<string> lstMessages = new List<string>();
    List<KeyValuePair<string, string>> lstMessageFilename = new List<KeyValuePair<string, string>>();
    FtpConfigurationElement ftpConfigElement = ftpConfig.FtpConfigElementColl[item.Destination];
    string InboundLocalArchivalPath = ftpConfigElement.LocalArchivalPath + Constants.CONS_INBOUNDFOLDER;
    string InboundInProgresspath = ftpConfigElement.InprogressPath + Constants.CONS_INBOUNDFOLDER;
    string[] arrFileExt = new string[] { Constants.CONS_INBOUNDMESSAGEEXT };

    //Process the the message, if message type present in App.Config.
    string[] filterMessageType = (ftpConfigElement.MessageTypes.Replace(Constants.CONS_MESSAGETYPESTART, "")).Split('|');

    //read and create string array from all messages in inbound directory
    try
    {
        //only gets the files from SFTP location
        try
        {
            SFTPClient.SftpDownloadFiles(ftpConfigElement.Server, ftpConfigElement.User, ftpConfigElement.Password, InboundInProgresspath, ftpConfigElement.InboundMsgPath, ftpConfigElement.InboundArchivePath, ftpConfigElement.ArchiveInboundMsg, ftpConfigElement.DeleteInboundMsg, ftpConfigElement.FingerPrint, arrFileExt, item.DBName, item.MessageTypes);
        }
        catch (Exception)
        {
            //Catch error logging completed in above function

            return lstMessages;
        }

        InboundInProgresspath = InboundInProgresspath + Constants.CONS_SINGLEBWSLASH + DateDir;

        if (Directory.Exists(InboundInProgresspath))
        {
            IEnumerable<string> arrInboundFileName = Directory.EnumerateFiles(InboundInProgresspath + Constants.CONS_SINGLEBWSLASH);
            List<string> processarrInboundFileName = new List<string>();
            string fileName = null;

            _logger.LogInfo(item.DBName + " - " + item.MessageTypes, Constants.CONS_INBOUNDPROCESS_MESSAGE_1);
            foreach (string file in arrInboundFileName)
            {
                try
                {
                    fileName = file.Substring(InboundInProgresspath.Length + 1, file.Length - (InboundInProgresspath.Length + 1));

                    ApplicationHeaderBlock applicationHeader = new ApplicationHeaderBlock(DeliveryHelper.ReadFile(file));

                    if (filterMessageType.Contains(applicationHeader.MessageType))
                    {
                        lstMessageFilename.Add(new KeyValuePair<string, string>(fileName, DeliveryHelper.ReadFile(file)));
                        lstMessages.Add(DeliveryHelper.ReadFile(file));
                        processarrInboundFileName.Add(file);
                        _logger.LogInfoFormat(item.DBName + " - " + item.MessageTypes, Constants.CONS_INBOUND_PROCESSED, applicationHeader.MessageType, fileName);
                    }
                    else
                    {
                        _logger.LogInfoFormat(item.DBName + " - " + item.MessageTypes, Constants.CONS_INBOUND_NOTPROCESSED, applicationHeader.MessageType, fileName);
                    }
                }
                catch (Exception ex)
                {
                    _logger.LogErrorMessage(item.DBName + " - " + item.MessageTypes, Constants.CONS_INBOUND_SWIFTMESSAGE_INVALID, ex,
                                            true, "ReadSwiftMessages", new string[] { "fileName" }, fileName);
                }
            }

            _logger.LogInfo(item.DBName + " - " + item.MessageTypes, Constants.CONS_INBOUNDPROCESS_MESSAGE_2);
            InboundSwiftMessageCollection swiftMessages = new InboundSwiftMessageCollection(lstMessages, tagCompData, lstMessageFilename);

            if (swiftMessages.Count > 0)
            {
                _logger.LogInfo(item.DBName + " - " + item.MessageTypes, Constants.CONS_INBOUNDPROCESS_MESSAGE_3);

                try
                {
                    SwiftInbound.UpdateInboundMessagesStatus(swiftMessages, item.DBName);
                }
                catch (Exception ex)
                {
                    if (ex.Source.ToUpper().Contains("SQLEXCEPTION") || ex.Source.ToUpper().Contains("SQLCONNECTION"))
                        _logger.LogFatalMessage(item.DBName + " - " + item.MessageTypes, Constants.CONS_INBOUNDPROCESS_MESSAGE_5, ex,
                                                Constants.CONS_METHOD_UPDATEINBOUNDMESSAGESSTATUS, new string[] { "DBName", "SwiftMessages" }, ftpConfigElement.DBName, swiftMessages);
                    else
                        _logger.LogErrorMessage(item.DBName + " - " + item.MessageTypes, Constants.CONS_INBOUNDPROCESS_MESSAGE_5, ex, true,
                                                Constants.CONS_METHOD_UPDATEINBOUNDMESSAGESSTATUS, new string[] { "DBName", "SwiftMessages" }, ftpConfigElement.DBName, swiftMessages);
                }
                _logger.LogInfo(item.DBName + " - " + item.MessageTypes, Constants.CONS_INBOUNDPROCESS_MESSAGE_4);
            }

            _logger.LogInfo(item.DBName + " - " + item.MessageTypes, " Inbound Messages - " + Constants.CONS_FTP_ARCHIVEFILE_START_MESSAGE);
            foreach (string file in arrInboundFileName)
            {
                if (ftpConfigElement.RenameInboundMsg)
                {
                    try
                    {
                        SFTPClient.SFtpRenameFile(ftpConfigElement.Server, ftpConfigElement.User, ftpConfigElement.Password, ftpConfigElement.InboundMsgPath, Path.GetFileName(file), Constants.CONS_OLDEXT, Constants.CONS_NEWEXT, ftpConfigElement.FingerPrint, ftpConfigElement.MessageTypes, ftpConfigElement.DBName);
                    }
                    catch (Exception)
                    {
                        //Catch error logging completed in above function
                        //Here it is not thrown ahead since below MoveFileFolder at LocalArchivalPath needs to be ran
                    }
                }
                ///moves the file from SFTP location to archive SFTP location
                if (ftpConfigElement.ArchiveInboundMsg)
                {
                    try
                    {
                        SFTPClient.SFtpArchiveFile(ftpConfigElement.Server, ftpConfigElement.User, ftpConfigElement.Password, ftpConfigElement.InboundMsgPath, ftpConfigElement.InboundArchivePath, file, ftpConfigElement.FingerPrint, ftpConfigElement.MessageTypes, ftpConfigElement.DBName);
                    }
                    catch (Exception)
                    {
                        //Catch error logging completed in above function
                        //Here it is not thrown ahead since below MoveFileFolder at LocalArchivalPath needs to be ran
                    }
                }
                DeliveryHelper.MoveFileToFolder(InboundInProgresspath, InboundLocalArchivalPath + Constants.CONS_SINGLEBWSLASH + DateDir + Constants.CONS_SINGLEBWSLASH, file, Path.GetFileName(file), true, item.DBName, item.MessageTypes);
            }
            _logger.LogInfo(item.DBName + " - " + item.MessageTypes, Constants.CONS_FTP_ARCHIVEFILE_STOP_MESSAGE);
        }
    }
    catch (Exception ex)
    {
        //Do not perform logging thrown by exceptions from inner functions
        if (ex.Message.Trim() != Constants.CONS_METHOD_SFTPDOWNLOADFILES.Trim() && ex.Message.Trim() != Constants.CONS_METHOD_SFTPARCHIVEFILE.Trim())
        {
            if (ex.Source.ToUpper().Contains("WINIOERROR"))
                _logger.LogFatalMessage(item.DBName + " - " + item.MessageTypes, Constants.CONS_MOVEFILETOFODER_1, ex, MethodBase.GetCurrentMethod());
            else
                _logger.LogErrorMessage(item.DBName + " - " + item.MessageTypes, Constants.CONS_INBOUNDPROCESS_MESSAGE_6, ex, false, MethodBase.GetCurrentMethod());
        }

    }
    return lstMessages;
}



=> InboundSwiftMessageCollection.cs :

public InboundSwiftMessageCollection(List<string> _messages, string _tagCompData, List<KeyValuePair<string, string>> lstMessageFilename)
{
    this.createSwiftMessages(_messages, _tagCompData, lstMessageFilename);
}

void createSwiftMessages(List<string> _messages, string _tagCompData, List<KeyValuePair<string, string>> lstMessageFilename)
{
    try
    {
        string[] fileContent = null;

        foreach (string message in _messages)
        {
            fileContent = message.Split(AppConfig.MultipleINBMsgSeperator.ToCharArray());
            string filename = lstMessageFilename.Where(x => x.Value.Equals(message)).FirstOrDefault().Key;

            if (fileContent != null && fileContent.Length > 0)
            {
                for (int i = 0; i < fileContent.Length; i++)
                {
                    InboundSwiftMessage swiftMessage = this.process(fileContent[i], _tagCompData, filename);

                    if (swiftMessage.IsValidMessage)
                        this.Add(swiftMessage);
                }
            }
        }
    }
    catch (Exception ex)
    {
        _logger.LogErrorMessage("", "Error at createSwiftMessages", ex, false, null);
    }
}

InboundSwiftMessage process(string _message, string _tagCompData, string filename)
{

    InboundSwiftMessage message = new InboundSwiftMessage(_message, _tagCompData, filename);


    return message; ;
}

=> InboundSwiftMessage.cs :


public class InboundSwiftMessage
{
    #region Variable Declaration

    private static Logger _logger = new Logger(typeof(InboundSwiftMessage));                
    BasicHeaderBlock basicHeader;
    ApplicationHeaderBlock applicationHeader;
    UserHeaderBlock userHeader;
    TextBlock text;
    string messageText;
    bool isValidMesage;
    string filename = null;

    #endregion

    public InboundSwiftMessage(string _message, string _tagCompData, string fileName)
    {
        try
        {
            this.messageText = _message;
            this.basicHeader = new BasicHeaderBlock(_message);
            this.applicationHeader = new ApplicationHeaderBlock(_message);
            this.userHeader = new UserHeaderBlock(_message);
            this.text = new TextBlock(_message, _tagCompData);
            this.filename = fileName;
            //Mark message as Invalid and don't process this if it is not Output message.
            if (InputOutputIdentifier == Constants.CONS_INBOUNDMSG_INPUT)
            {
                this.isValidMesage = false;
            }
            else
            {
                this.isValidMesage = true;
            }


        }
        catch (Exception ex)
        {
            this.isValidMesage = false;
            _logger.LogFatalMessage("", Constants.CONS_READ_SWIFTMESSAGE_ERROR, ex, MethodBase.GetCurrentMethod(), _message);
        }
    }

    public string MessageType
    {
        get
        {
            return this.applicationHeader.MessageType;
        }
    }

    public TextBlock Text
    {
        get
        {
            return this.text;
        }
    }

    public string MessageText
    {
        get
        {
            return this.messageText;
        }
    }

    public bool IsValidMessage
    {
        get
        {
            return this.isValidMesage;
        }
    }

    public ApplicationHeaderBlock ApplicationHeaderText
    {
        get
        {
            return this.applicationHeader;
        }
    }

    public UserHeaderBlock UserHeaderBlockText
    {
        get
        {
            return this.userHeader;
        }
    }

    public string InputOutputIdentifier
    {
        get
        {
            return this.applicationHeader.InputOutputIdentifier;
        }
    }

    public string FileName
    {
        get
        {
            return this.filename;
        }
    }
}

=> BasicHeaderBlock.cs :

 public class BasicHeaderBlock : SwiftBlock
 {

     string block1Start = null;
     protected string applicationId = null;            
     string serviceId = null;                          
     string logicalTerminalAddress = null;               
     string sessionNumber = null;
     private string sequenceNumber = null;

     public string Block1Start
     {
         
         get
         {
             return this.block1Start;
         }

         set
         {
             this.block1Start = value;
         }
     }

     public string ApplicationId
     {
         get
         {
             return this.applicationId;
         }
         set
         {
             this.applicationId = value;
         }
     }

     public string ServiceId
     {
         get
         {
             return this.serviceId;
         }
         set
         {
             this.serviceId = value;
         }
     }

     public string LogicalTerminalAddress
     {

         get
         {
             return this.logicalTerminalAddress;
         }
         set
         {
             this.logicalTerminalAddress = value;
         }
     }

     public string SessionNumber
     {

         get
         {
             return this.sessionNumber;
         }
         set
         {
             this.sessionNumber = value;
         }
     }

     public string SequenceNumber
     {
         get
         {
             return this.sequenceNumber;
         }
         set
         {
             this.sequenceNumber = value;
         }
     }

     public BasicHeaderBlock(string _applicationId, string _serviceId, string _logicalTerminalAddress, string _sessionNumber, string _sequenceNumber)
     {
         this.block1Start = Common.Constants.CONS_BLOCK1START;
         //this.blockIdentifier = Smtb.SWIFTFramework.SwiftUtility.Common.Constants.CONS_BLOCK1IDENTIFIER;
         this.applicationId = _applicationId;
         this.serviceId = _serviceId;
         this.logicalTerminalAddress = _logicalTerminalAddress;
         this.sessionNumber = _sessionNumber;
         this.sequenceNumber = _sequenceNumber;
     }

     public BasicHeaderBlock(string _message)
     {
         this.blockIdentifier = Constants.CONS_BLOCK1IDENTIFIER;

         string[] arrMessageBlocks = _message.Split((Constants.CONS_BLOCKSEPERATOR).ToCharArray());

         if (arrMessageBlocks.Length > 0)
         {
             this.blockContent = arrMessageBlocks[0].Substring(3);
         }
     }

     public BasicHeaderBlock()
     {

     }

 }


=> SwiftBlock.cs :

public class SwiftBlock
 {
     protected string blockIdentifier;

     public string BlockIdentifier
     {
         get
         {
             return this.blockIdentifier;
         }
     }

     protected string blockContent;

     public string BlockContent
     {
         get
         {
             return this.blockContent;
         }
     }
 }

=> ApplicationHeaderBlock.cs :

public class ApplicationHeaderBlock : SwiftBlock
{
    private static Logger _logger = new Logger(typeof(ApplicationHeaderBlock));

    string block2Start = null;
    protected string inputOutputIdentifier = null;
    string messageType = null;
    string messagePriority = null;
    string recipientAddress = null;
    private string deliveryMonitoring = null;
    string obsolescencePeriod = null;
    string inputTime = null;
    string inputDate = null;
    string messageInputReference = null;                //MIR
    string outputDateTime = null;
    string sessionNumber = null;
    string sequenceNumbe = null;

    public string Block2Start
    {
        get
        {
            return this.block2Start;
        }
    }

    public string InputOutputIdentifier
    {
        get
        {
            return this.inputOutputIdentifier;
        }
    }

    public string RecipientAddress
    {
        get
        {
            return this.recipientAddress;
        }

        set
        {
            this.recipientAddress = value;
        }
    }

    public string MessageType
    {
        get
        {
            return this.messageType;
        }

        set
        {
            this.messageType = value;
        }
    }

    public string MessagePriority
    {
        get
        {
            return this.messagePriority;
        }

        set
        {
            this.messagePriority = value;
        }
    }

    public string DeliveryMonitoring
    {
        get
        {
            return this.deliveryMonitoring;
        }

        set
        {
            this.deliveryMonitoring = value;
        }
    }

    public string ObsolescencePeriod
    {
        get
        {
            return this.obsolescencePeriod;
        }
        set
        {
            this.obsolescencePeriod = value;
        }
    }

    public string InputDate
    {
        get
        {
            return this.inputDate;
        }
    }

    public string MessageInputReference
    {
        get
        {
            return this.messageInputReference;
        }
    }

    public string OutputDateTime
    {
        get
        {
            return this.outputDateTime;
        }
    }

    public string SessionNumber
    {
        get
        {
            return this.sessionNumber;
        }
        set
        {
            this.sessionNumber = value;
        }
    }

    public string SequenceNumbe
    {
        get
        {
            return this.sequenceNumbe;
        }
        set
        {
            this.sequenceNumbe = value;
        }
    }

    //Outbound
    public ApplicationHeaderBlock()
    {

    }

    //Outbound
    public ApplicationHeaderBlock(string MessageType, string RecipientAdd, string MessagePriority, string DeliveryMonitoring, string ObsolescencePeriod)
    {
        this.block2Start = Constants.CONS_BLOCK2START;
        //this.blockIdentifier = Constants.CONS_BLOCK2IDENTIFIER;
        this.inputOutputIdentifier = Constants.CONS_INBOUNDMSG_INPUT;
        this.messageType = MessageType;
        //this.inputDate = DateTime.Now.ToShortDateString(); // need to check
        //this.inputTime = DateTime.Now.ToShortTimeString(); // need to check
        this.recipientAddress = RecipientAdd;
        //this.outputDateTime = DateTime.Now.ToString(); // need to check
        this.messagePriority = MessagePriority;
        this.deliveryMonitoring = DeliveryMonitoring;
        this.obsolescencePeriod = ObsolescencePeriod;
    }

    //Inbound
    public ApplicationHeaderBlock(string _message)
    {
        this.blockIdentifier = Constants.CONS_BLOCK2IDENTIFIER;

        string[] arrMessageBlocks = _message.Split((Constants.CONS_BLOCKSEPERATOR).ToCharArray());

        if (arrMessageBlocks.Length > 1)
        {
            this.blockContent = arrMessageBlocks[1].Substring(3);

            if (this.blockContent.StartsWith(Constants.CONS_INBOUNDMSG_INPUT))
            {
                this.inputOutputIdentifier = this.blockContent.Substring(0, 1);
                //Log this message details as it is Invalid.
                _logger.LogInfoFormat(Constants.CONS_INBOUND_SWIFTMESSAGE_INVALID, _message);
            }
            else
            {
                this.inputOutputIdentifier = this.blockContent.Substring(0, 1);
                this.messageType = /*Constants.CONS_MESSAGETYPESTART + */this.blockContent.Substring(1, 3);
                this.inputTime = this.blockContent.Substring(4, 4);
                //this.inputDate = this.blockContent.Substring(8, 6);
                this.messageInputReference = this.blockContent.Substring(8, 28);
                //this.recipientAddress = this.blockContent.Substring(14, 12);
                //this.sessionNumber = this.blockContent.Substring(26, 4);
                //this.sequenceNumbe = this.blockContent.Substring(30, 6);
                this.outputDateTime = this.blockContent.Substring(36, 10);
                this.messagePriority = this.blockContent.Substring(46, 1);
            }
        }
    }
}

=> UserHeaderBlock.cs :

public class UserHeaderBlock : SwiftBlock
{
    string block3Start = null;
    string bankingPriorityCode = null;

    public string Block1Start
    {

        get
        {
            return this.block3Start;
        }

        set
        {
            this.block3Start = value;
        }
    }

    public string BankingPriorityCode
    {
        get
        {
           return  this.bankingPriorityCode;
        }
    }

    string isitcVersionIdentifier = null;
    string messageUserReference = null;

    public string IsitcVersionIdentifier
    {
        get
        {
            return this.isitcVersionIdentifier;
        }
    }

    public string MessageUserReference
    {
        get
        {
            return this.messageUserReference;
        }
    }


    public UserHeaderBlock()
    {

    }

    //public UserHeaderBlock(string _bankingPriorityCode)
    //{
    //    this.block3Start = Smtb.SWIFTFramework.SwiftUtility.Common.Constants.CONS_BLOCK3START;
    //    this.bankingPriorityCode = _bankingPriorityCode;
    //}

    public UserHeaderBlock(string _message)
    {
        this.blockIdentifier = Constants.CONS_BLOCK3START;

        if (_message.Contains(Constants.CONS_BLOCK3START))
        {
            this.blockContent = _message.Substring(_message.IndexOf(Constants.CONS_BLOCK3START), (_message.IndexOf(Constants.CONS_BLOCK3END) - _message.IndexOf(Constants.CONS_BLOCK3START)));

            if (_message.Contains(Constants.CONS_BLOCK3TAG108))
            {
                this.messageUserReference = _message.Substring(_message.IndexOf(Constants.CONS_BLOCK3TAG108), (_message.IndexOf(Constants.CONS_BLOCK3END) - _message.IndexOf(Constants.CONS_BLOCK3TAG108)));
            }
        }
    }

}

=> TextBlock.cs :

public class TextBlock : SwiftBlock
{
    string message;
    private String CrLf = "";
    private String LineBreak = ":";
    List<SwiftTag> tags = new List<SwiftTag>();
    List<Sequence> sequences = null;//new List<Sequence>();
    private string block4Start;
    private string tagCompData;
    private static ILog _logger = LogManager.GetLogger(typeof(TextBlock));

    public string Block4Start
    {

        get
        {
            return this.block4Start;
        }

        set
        {
            this.block4Start = value;
        }
    }

    public List<Sequence> Sequence
    {
        get
        {
            return this.sequences;
        }
    }

    public List<SwiftTag> SwiftTag
    {
        get
        {
            return this.tags;
        }
    }

    public string TagCompData
    {
        get
        {
            return this.tagCompData;
        }
        set
        {
            this.tagCompData = value;
        }
    }

    public TextBlock()
    {

    }

    public TextBlock(string _message, string _tagCompData)
    {
        char[] c = { '\r', '\n' };
        String s = new String(c);
        setCrLf(s);

        if (_message.Length > 0)
        {
            this.blockIdentifier = Constants.CONS_BLOCK4IDENTIFIER;
            this.blockContent = _message.Substring(_message.IndexOf(Constants.CONS_BLOCK4START), (_message.LastIndexOf(Constants.CONS_BLOCKSEPERATOR) - _message.IndexOf(Constants.CONS_BLOCK4START)));
            this.message = blockContent;
            this.tagCompData = _tagCompData;
            this.parseTags();
        }
    }

    public TextBlock(List<Sequence> _sequence)
    {
        char[] c = { '\r', '\n' };
        String s = new String(c);
        setCrLf(s);

        //if (_message.Length > 0)
        //{
        this.block4Start = Common.Constants.CONS_BLOCK4START;
        this.sequences = _sequence;
        //this.blockContent = _message.Substring(_message.IndexOf(Constants.CONS_BLOCK4START), (_message.LastIndexOf(Constants.CONS_BLOCKSEPERATOR) - _message.IndexOf(Constants.CONS_BLOCK4START)));
        //this.message = blockContent;
        //this.parseTags();
        //}
    }

    private void setCrLf(string newCrLf)
    {
        this.CrLf = newCrLf;
    }

    void parseTags()
    {
        //parse and add tags to list
        //parse and add tags to list
        SwiftTag tag = null;
        string[] arrTag = null;
        string[] arrTagVal = null;
        string tagCode = string.Empty;
        string tagValue = string.Empty;
        bool tagfound = false;
        int lineNbr = 0;


        XmlDocument doc = new XmlDocument();
        XmlReader xReader = XmlReader.Create(new StringReader(this.tagCompData));

        System.Data.DataSet ds = new System.Data.DataSet();
        ds.ReadXml(xReader);

        System.Data.DataTable dtTagCompData = ds.Tables[0];
        System.Data.DataRow[] drTagValue = null;
        System.Data.DataRow[] drTagHaDelimeter = null;

        foreach (String line in message.Split(CrLf.ToCharArray()))
        {
            //Case when line does not start with ':' and is the  value of the previous tag
            if (line != string.Empty && !line.StartsWith(Constants.CONS_TAGSTART) && !line.Contains(Constants.CONS_TAGSTART))
            {
                SwiftTag stag = tags.Where(x => x.TagCode.Equals(tagCode)).LastOrDefault();
                tags.Remove(stag);
                tag = new SwiftTag(stag.TagName, stag.TagCode, (stag.TagValue + " " + line).Trim().ToString(), stag.CompPosition, stag.InstanceNumber, stag.LineNbr);
                tags.Add(tag);
            }

            if (line != string.Empty && line.StartsWith(Constants.CONS_TAGSTART))
            {
                //tagCode = string.Empty;
                tagValue = string.Empty;
                tagfound = false;

                arrTag = line.Split(new[] { Convert.ToChar(Constants.CONS_TAGSTART) }, 4);  // This check is used to keep value of tag unchange, if Value contains extra ':' then value will remain as it is.
                lineNbr = lineNbr + 1;


                //foreach (var arrItem in arrTag)
                //{
                for (int iTag = 0; iTag < arrTag.Length; iTag++)
                {
                    if (arrTag[iTag] != null && arrTag[iTag] != string.Empty)
                    {
                        if ((arrTag[iTag].Length == 3 || arrTag[iTag].Length == 2) && tagfound == false) //Added condition for length =2 MT398 and MT396 messages.
                        {
                            tagCode = arrTag[iTag];
                            drTagValue = null;
                            tagfound = true;
                        }
                        else
                        {
                            drTagValue = dtTagCompData.Select("Tag ='" + tagCode + "'");


                            arrTagVal = new string[arrTag[iTag].Split('/').Length];
                            arrTagVal = arrTag[iTag].Split('/');

                            if (arrTagVal.Length != drTagValue.Length)
                            {
                                arrTagVal = arrTagVal.Where(w => w != string.Empty).ToArray();
                            }
                            //-----Start MT103 70 Tag Handling------
                            /*:70:/BNF/REF:FFC FIERA AXIUM INFRASTRUC
                                    TURE NORTH AMERICA IV L.P.,CUSTODY 
                                    BANK OF JAPAN, LTD. AC.12345-1234*/
                            //if 70 tag has above tagvalue with extra : in tagvalue then do not split 
                            /*if 70 tag has :70:/INV/abc/SDF-96//1234-234///ROC/98I U87
                             It contain /// in value so don not split this value into two diffrent value*/

                            if (tagCode == "70")
                            {
                                arrTag = line.Split(new[] { Convert.ToChar(Constants.CONS_TAGSTART) }, 3);//if extra colon come in to tag value then sont split
                                arrTagVal = new string[1];// Array reset
                                arrTagVal[0] = arrTag[iTag];//asign single tagvalue of 70 tag into arrTagVal

                            }
                            //-------End MT103 70 tag--------------
                            //start :Commented to resolve MT398 TAg76 issue fix 
                            //if (arrTagVal.Length != drTagValue.Length && arrTagVal.Length > drTagValue.Length && arrTagVal.Length >=4)
                            //{

                            //string[] stringSeparators = new string[] { "//" };
                            //arrTagVal = arrTag[iTag].Split(stringSeparators, StringSplitOptions.None);  
                            //}
                            //End

                            //New code for MT398 Tag76 issue fix and Tag 70D issue fix
                            if (arrTagVal.Length != drTagValue.Length && arrTagVal.Length > drTagValue.Length)
                            {
                                //Start - New Code for handling Tag 70D split based on Postfix and component count
                                if (tagCode == "70D")
                                {
                                    string SplitChar = string.Empty;

                                    if (!string.IsNullOrEmpty(drTagValue[0]["Postfix"].ToString()))
                                    {
                                        SplitChar = drTagValue[0]["Postfix"].ToString();
                                    }
                                    else
                                    {
                                        SplitChar = "//";
                                    }

                                    string[] stringSeparators = new string[] { SplitChar };//In case of 70D, split will be based on postfix of 1st component
                                    arrTagVal = arrTag[iTag].Split(stringSeparators, StringSplitOptions.None);
                                }
                                //End - New Code for handling Tag 70D split based on Postfix and component count

                                if (arrTagVal.Length >= 4 || drTagValue.Length == 1)
                                {
                                    string[] stringSeparators = new string[] { "//" };
                                    arrTagVal = arrTag[iTag].Split(stringSeparators, StringSplitOptions.None);

                                }
                            }
                            //End New code for MT398 TAg76 issue fix 

                            //MT970 code changes , message value without separator //
                            //if tag table has this field on
                            try
                            {
                                drTagHaDelimeter = dtTagCompData.Select("HasDelimiter ='" + 0 + "' and tagCode in ('60F','60M','62F','62M','64','61')");
                                if (drTagHaDelimeter.Length > 0 && (tagCode == "60F" || tagCode == "60M" || tagCode == "62F" || tagCode == "62M" || tagCode == "64" || tagCode == "61"))
                                {
                                    if (arrTagVal.Length < drTagValue.Length)
                                    {
                                        ParseMt970(tagCode, ref arrTagVal);
                                    }
                                } //has separator if
                                //end 
                            }
                            catch (Exception ex)
                            {
                                continue;
                            }

                            for (int iTagVal = 0; iTagVal < arrTagVal.Length; iTagVal++)
                            {
                                tag = new SwiftTag(tagCode.Substring(0, 2), tagCode, arrTagVal[iTagVal], (iTagVal + 1).ToString(), "1", lineNbr.ToString());
                                tags.Add(tag);
                            }

                        }
                    }

                }
                //For TagCode that dosn't have values 
                if (tagCode != null && tagCode != string.Empty && drTagValue == null)
                {
                    tag = new SwiftTag(tagCode.Substring(0, 2), tagCode, null, "1", "1", lineNbr.ToString());
                    tags.Add(tag);
                }
            }

        }
    }

    public SwiftTag this[string _tagname]
    {
        get
        {
            SwiftTag tag = tags.Find(item => item.TagName == _tagname);

            return tag;
        }
    }


    public void ParseMt970(string tagCode, ref string[] arrTagVal) //arrTagVal_0, string arrTagVal_1  )
    {
        string strNonSplitValue = "";
        string[] arrTagVal970 = null;
        if (tagCode == "60F" || tagCode == "60M" || tagCode == "62F" || tagCode == "62M" || tagCode == "64")
        {
            arrTagVal970 = new string[4];
            strNonSplitValue = arrTagVal[0];
            arrTagVal970[0] = strNonSplitValue.Substring(0, 1);
            arrTagVal970[1] = strNonSplitValue.Substring(1, 6);
            arrTagVal970[2] = strNonSplitValue.Substring(7, 3);
            arrTagVal970[3] = strNonSplitValue.Substring(10).TrimEnd(',');
            arrTagVal = new string[4];
            Array.Copy(arrTagVal970, arrTagVal, 4);
        }

        if (tagCode == "61")
        {
            int n;
            arrTagVal970 = new string[10];
            strNonSplitValue = arrTagVal[0];
            arrTagVal970[0] = strNonSplitValue.Substring(0, 6);
            int nAmountEndPos = 0;
            // check if entry date provided
            if (!int.TryParse(strNonSplitValue.Substring(6, 1), out n))
            {
                arrTagVal970[1] = ""; //no entry date
                //if (!int.TryParse(strNonSplitValue.Substring(12, 2), out n))
                if (!int.TryParse(strNonSplitValue.Substring(7, 1), out n)) //RC/RD mark
                {

                    arrTagVal970[2] = strNonSplitValue.Substring(6, 2); //RC/RD mark
                    //transaction type : S/N/F
                    if (strNonSplitValue.IndexOf("N") == -1)
                    {
                        if (strNonSplitValue.IndexOf("S") == -1)
                            nAmountEndPos = strNonSplitValue.IndexOf("F");
                        else
                            nAmountEndPos = strNonSplitValue.IndexOf("S");
                    }
                    else
                        nAmountEndPos = strNonSplitValue.IndexOf("N");

                    int length = nAmountEndPos - 8; //7
                    arrTagVal970[3] = ""; //Funds code 
                    arrTagVal970[4] = strNonSplitValue.Substring(8, length).TrimEnd(',');
                    arrTagVal970[5] = strNonSplitValue.Substring(nAmountEndPos, 1); //transaction type
                    arrTagVal970[6] = strNonSplitValue.Substring(nAmountEndPos + 1, 3);//Identification Code
                    arrTagVal970[7] = strNonSplitValue.Substring(nAmountEndPos + 4);
                    arrTagVal970[8] = arrTagVal[1]; // arrTag[0].Split("//")[1];//, StringSplitOptions.None))[1];
                    arrTagVal970[9] = "";
                }
                else
                {
                    //arrTagVal970[2] = strNonSplitValue.Substring(11, 2); //RC/RD mark
                    arrTagVal970[2] = strNonSplitValue.Substring(6, 1); //C/D mark
                    if (strNonSplitValue.IndexOf("N") == -1)
                    {
                        if (strNonSplitValue.IndexOf("S") == -1)
                            nAmountEndPos = strNonSplitValue.IndexOf("F");
                        else
                            nAmountEndPos = strNonSplitValue.IndexOf("S");
                    }
                    else
                        nAmountEndPos = strNonSplitValue.IndexOf("N");

                    int length = nAmountEndPos - 7; // 12;
                    arrTagVal970[3] = ""; //Funcode 
                    arrTagVal970[4] = strNonSplitValue.Substring(7, length);
                    arrTagVal970[5] = strNonSplitValue.Substring(nAmountEndPos, 1); //transaction type
                    arrTagVal970[6] = strNonSplitValue.Substring(nAmountEndPos + 1, 3);//Identification Code
                    arrTagVal970[7] = strNonSplitValue.Substring(nAmountEndPos + 4);
                    arrTagVal970[8] = arrTagVal[1]; // arrTag[0].Split("//")[1];//, StringSplitOptions.None))[1];
                    arrTagVal970[9] = "";
                }
            }
            else
            {
                arrTagVal970[1] = strNonSplitValue.Substring(6, 4);// entry date

                if (!int.TryParse(strNonSplitValue.Substring(11, 1), out n)) //debit credit mark 
                {
                    arrTagVal970[2] = strNonSplitValue.Substring(10, 2);//C/D mark
                    if (strNonSplitValue.IndexOf("N") == -1)
                    {
                        if (strNonSplitValue.IndexOf("S") == -1)
                            nAmountEndPos = strNonSplitValue.IndexOf("F");
                        else
                            nAmountEndPos = strNonSplitValue.IndexOf("S");
                    }
                    else
                        nAmountEndPos = strNonSplitValue.IndexOf("N");

                    int length = nAmountEndPos - 12;
                    arrTagVal970[3] = ""; //Funcode 
                    arrTagVal970[4] = strNonSplitValue.Substring(12, length);
                    arrTagVal970[5] = strNonSplitValue.Substring(nAmountEndPos, 1); //transaction type
                    arrTagVal970[6] = strNonSplitValue.Substring(nAmountEndPos + 1, 3);//Identification Code
                    arrTagVal970[7] = strNonSplitValue.Substring(nAmountEndPos + 4);
                    arrTagVal970[8] = arrTagVal[1]; // arrTag[0].Split("//")[1];//, StringSplitOptions.None))[1];
                    arrTagVal970[9] = "";

                }
                else
                {
                    arrTagVal970[2] = strNonSplitValue.Substring(10, 1);//RC/RD mark
                    if (strNonSplitValue.IndexOf("N") == -1)
                    {
                        if (strNonSplitValue.IndexOf("S") == -1)
                            nAmountEndPos = strNonSplitValue.IndexOf("F");
                        else
                            nAmountEndPos = strNonSplitValue.IndexOf("S");
                    }
                    else
                        nAmountEndPos = strNonSplitValue.IndexOf("N");

                    int length = nAmountEndPos - 11;
                    arrTagVal970[3] = ""; //Funcode 
                    arrTagVal970[4] = strNonSplitValue.Substring(11, length);
                    arrTagVal970[5] = strNonSplitValue.Substring(nAmountEndPos, 1); //transaction type
                    arrTagVal970[6] = strNonSplitValue.Substring(nAmountEndPos + 1, 3);//Identification Code
                    arrTagVal970[7] = strNonSplitValue.Substring(nAmountEndPos + 4);
                    arrTagVal970[8] = arrTagVal[1]; // arrTag[0].Split("//")[1];//, StringSplitOptions.None))[1];
                    arrTagVal970[9] = ""; //additional info
                }
            }
            arrTagVal = new string[10];
            Array.Copy(arrTagVal970, arrTagVal, 10);
        }
    }


}

=> SwiftTag.cs :

public class SwiftTag
 {
     private string tagName;
     private string tagValue;
     private string tagQualifierId;
     private string tagCode;
     private string regExFormat;
     private string tagCompPosition;
     private string tagInstanceNumber;
     private string lineNbr;

     public string TagName
     {
         get
         {
             return tagName;
         }
     }

     public string TagValue
     {
         get
         {
             return tagValue;
         }
     }
 
     public string TagCode
     {
         get
         {
             return this.tagCode;
         }
     }

     public string CompPosition
     {
         get
         {
             return this.tagCompPosition;
         }
     }

     public string InstanceNumber
     {
         get 
         {
             return this.tagInstanceNumber;
         }
     }

     public string LineNbr
     {
         get
         {
             return this.lineNbr;
         }
     }

     public SwiftTag(string _tagname, string _tagCode , string _tagvalue, string _tagCompPosition, string _tagInstanceNumber)
     {
         tagName = _tagname;
         tagValue = _tagvalue;
         tagCode = _tagCode;
         tagCompPosition = _tagCompPosition;
         tagInstanceNumber = _tagInstanceNumber;
     }

     public SwiftTag(string _tagname, string _tagCode, string _tagvalue, string _tagCompPosition, string _tagInstanceNumber,string _lineNbr)
     {
         tagName = _tagname;
         tagValue = _tagvalue;
         tagCode = _tagCode;
         tagCompPosition = _tagCompPosition;
         tagInstanceNumber = _tagInstanceNumber;
         lineNbr = _lineNbr;
     }
    
 }


=> Sequence.cs :

public class Sequence
{
    List<SwiftTag> tags = null;//new List<SwiftTag>();
    List<Sequence> relatedSequences = null;
    private bool isMandatory;
    private string seqNo;
    private string seqInstanceNumber;

    public List<SwiftTag> Tags
    {
        get
        {
            return this.tags;
        }
        set
        {
            this.tags = value;
        }
    }

    public List<Sequence> RelatedSequences
    {
        get
        {
            return this.relatedSequences;
        }
        set
        {
            this.relatedSequences = value;
        }
    }

    public bool IsMandatory
    {
        get
        {
            return isMandatory;
        }
        set
        {
            this.isMandatory = value;
        }
    }

    public string SeqNo
    {
        get
        {
            return seqNo;
        }
        set
        {
            this.seqNo = value;
        }
    }

    public string SeqInstanceNumber
    {
        get
        {
            return seqInstanceNumber;
        }
        set
        {
            this.seqInstanceNumber = value;
        }
    }

    public Sequence()
    {
                   
    }

    public SwiftTag this[string _tagname]
    {
        get
        {
            SwiftTag tag = tags.Find(item => item.TagName == _tagname);

            return tag;
        }
    }

    #region PropertiesUsedInWCF
    /// <summary>
    /// Gets or Sets Parent Sequence Name
    /// </summary>
    public string swiftParentSeqName { get; set; }

    /// <summary>
    /// Gets or Sets Child Sequence Name
    /// </summary>
    public string swiftSeqName { get; set; }

    /// <summary>
    /// Gets or Sets Parent Sequence Position
    /// </summary>
    public int swiftParentSeqPosition { get; set; }

    /// <summary>
    /// Gets or Sets Sequence Position
    /// </summary>
    public int swiftSeqPosition { get; set; }

    /// <summary>
    /// Gets or Sets Sequence position assigned by windows service
    /// </summary>
    public int swiftActualSeqPosition { get; set; }

    /// <summary>
    /// Gets or Sets Sequence Instance Number
    /// </summary>
    public int swiftSeqInstance { get; set; }

    /// <summary>
    /// Gets or Sets Is Sequence Mandatory
    /// </summary>
    public bool swiftIsSeqMandatory { get; set; }

    /// <summary>
    /// Gets or Sets Tag Code
    /// </summary>
    public string swiftTagCode { get; set; }

    /// <summary>
    /// Gets or Sets count
    /// </summary>
    public int swiftRecordCount { get; set; }

    #endregion
}


public static void UpdateInboundMessagesStatus(InboundSwiftMessageCollection _messages, string itemDBName)
{
    DataSet dsResult = null;

    string swiftMessageXml = null;
    StringBuilder sbSwiftMesage = new StringBuilder();
    StringBuilder sbAttributeList = new StringBuilder();
    string MessageDirection = Constants.CONS_MESSAGEDIRECTION;
    int MessageStatusId = OutboundStatusTypeData.CONS_MESSAGE_CREATED;
    string InboundMUR = string.Empty;
    string xmlSwiftData = string.Empty;
    bool blnSuccess = false;
    DataTable dtSwiftTag = new DataTable();
    string ParsedFileName = string.Empty;

    //for each message update database
    foreach (var message in _messages)
    {
        try
        {
            dtSwiftTag = new DataTable();

            dtSwiftTag = Common.Common.CreateDataTable(message.Text.SwiftTag);
            dtSwiftTag.TableName = Common.Constants.CONS_TBL_TAGCOMP;

            InboundMUR = message.Text[Constants.CONS_BLOCK3TAG108] != null ? message.Text[Constants.CONS_BLOCK3TAG108].TagValue : string.Empty;
            sbSwiftMesage = new StringBuilder();
            sbAttributeList = new StringBuilder();
            swiftMessageXml = null;
            xmlSwiftData = null;
            ParsedFileName = string.Empty;
            ParsedFileName = message.FileName;
            sbSwiftMesage.Append
               (
                    Convert.ToString(message.Text[Constants.CONS_BLOCK4TAG20].TagValue) +
                    Constants.CONS_SEMICOLON +
                    string.Empty /*Convert.ToInt32(message.Text[Constants.CONS_BLOCK4TAG21].TagValue) */ +
                    Constants.CONS_SEMICOLON +
                    message.MessageType +
                    Constants.CONS_SEMICOLON +
                    message.MessageText +
                    Constants.CONS_SEMICOLON +
                    MessageDirection +
                    Constants.CONS_SEMICOLON +
                    MessageStatusId +
                    Constants.CONS_SEMICOLON +
                    InboundMUR +
                    Constants.CONS_SEMICOLON +
                    message.Text[Constants.CONS_BLOCK4TAG20].TagValue +
                    Constants.CONS_SEMICOLON +
                    message.ApplicationHeaderText.RecipientAddress +
                    Constants.CONS_PIPESEPERATOR
               );

            sbAttributeList.Append(Constants.CONS_INBOUNDXMLATTR);
            swiftMessageXml = Common.Common.ConvertStringToXML(sbSwiftMesage.ToString(), sbAttributeList.ToString(), Convert.ToChar(Constants.CONS_SEMICOLON)).ToString();

            xmlSwiftData = Common.Common.GetXMLData(dtSwiftTag);

            // escape single quotes from message XML (Fix issue in TAG 70D of MT537, reason column , value with single quote - 'On Hold')
            swiftMessageXml = swiftMessageXml.Replace("'", "&apos;");
            xmlSwiftData = xmlSwiftData.Replace("'", "&apos;");
            //update db in one call
            dsResult = SWIFTInbound.SaveInboundMessage(message.MessageType, ParsedFileName, ModifiedBy, itemDBName, xmlSwiftData, swiftMessageXml, ref blnSuccess);

            if (dsResult != null && dsResult.Tables.Count > 0)
            {
                bool isSuccess = Convert.ToBoolean(dsResult.Tables[0].Rows[0][Constants.COL_ISSUCESS]);
                
                if (!isSuccess)
                    _logger.LogErrorMessage(itemDBName + " - MT" + message.MessageType, Constants.CONS_ERROR_SAVING_INBOUNDFILE, null, true,
                                            Constants.CONS_METHOD_SAVEINBOUNDMESSAGE, new string[] { "ParsedFileName", "Error Message" },
                                            ParsedFileName, Convert.ToString(dsResult.Tables[0].Rows[0][Constants.CONS_COL_MESSAGE_CODE]));
                else
                    _logger.LogInfoFormat(itemDBName + " - MT" + message.MessageType, Constants.CONS_SAVED_INBOUNDFILE + ParsedFileName);
            }
        }
        catch (Exception ex)
        {
            if (ex.Message.Trim() != Constants.CONS_METHOD_SAVEINBOUNDMESSAGE.Trim())
            {
                _logger.LogErrorMessage(itemDBName + " - MT" + message.MessageType, Constants.CONS_PARSE_INBOUND_MESSAGE_ERROR, ex, true,
                                        Constants.CONS_METHOD_UPDATEINBOUNDMESSAGESSTATUS, new string[] { "ParsedFileName" }, ParsedFileName);
            }
        }
    }
}


=> Common.cs :

public static class Common
{
    public static StringBuilder ConvertStringToXML(string itemList, string attributeNameList, char stringSeperator)
    {
        StringBuilder XmlDoc = new StringBuilder();
        string[] list1 = itemList.Split('|');
        string[] list2 = null;
        string[] attrList = attributeNameList.Split('|');
        int RecCount = 0;

        XmlDoc.Append(Constants.CONS_XML_ROOT_START);

        for (int i = 0; i < list1.Length; i++)
        {
            if (list1[i] != string.Empty)
            {
                XmlDoc.Append(Constants.XML_VALUE_STARTTAG);

                list2 = list1[i].Split(stringSeperator);
                //XmlDoc.Append("<");

                for (int j = 0; j < attrList.Length; j++)
                {
                    XmlDoc.Append(attrList[j] + "=");
                    XmlDoc.Append("\"");
                    XmlDoc.Append(list2[j].ToString());
                    XmlDoc.Append("\" ");
                }

                XmlDoc.Append(">");
                XmlDoc.Append(Constants.XML_VALUE_ENDTAG);
                RecCount++;
            }
        }

        XmlDoc.Append(Constants.CONS_XML_ROOT_END);

        if (RecCount == 0)
        {
            XmlDoc.Length = 0;
            return XmlDoc;
        }
        return XmlDoc;
    }

    public static DataTable CreateDataTable<T>(IEnumerable<T> list)
    {
        Type type = typeof(T);
        var properties = type.GetProperties();

        DataTable dataTable = new DataTable();
        foreach (PropertyInfo info in properties)
        {
            dataTable.Columns.Add(new DataColumn(info.Name, Nullable.GetUnderlyingType(info.PropertyType) ?? info.PropertyType));
        }

        foreach (T entity in list)
        {
            object[] values = new object[properties.Length];
            for (int i = 0; i < properties.Length; i++)
            {
                values[i] = properties[i].GetValue(entity);
            }

            dataTable.Rows.Add(values);
        }

        return dataTable;
    }

    public static string GetXMLData(DataTable dtXMLData)
    {

        string xmlString = string.Empty;
        using (TextWriter writer = new StringWriter())
        {
            dtXMLData.WriteXml(writer);
            xmlString = writer.ToString();
        }
        return xmlString;
    }

    public static string ConvertObjectToXMLString(object classObject)
    {
        string xmlString = null;
        XmlSerializer xmlSerializer = new XmlSerializer(classObject.GetType());
        using (MemoryStream memoryStream = new MemoryStream())
        {
            xmlSerializer.Serialize(memoryStream, classObject);
            memoryStream.Position = 0;
            xmlString = new StreamReader(memoryStream).ReadToEnd();
        }
        return xmlString;
    }

}


public static DataSet SaveInboundMessage(string MessageType, string ParsedFileName, string UserId, string applicationDBName, string xmlSwiftData, string xmlInboundSwiftData, ref bool blnSuccess)
{
    return SwiftInboundDAL.SaveInboundMessage(MessageType, ParsedFileName, UserId, applicationDBName, xmlSwiftData, xmlInboundSwiftData, ref blnSuccess);
}


public static DataSet SaveInboundMessage(string MessageType, string ParsedFileName, string UserId, string applicationDBName, string xmlSwiftData, string xmlInboundSwiftData, ref bool blnSuccess)
{
    try
    {
        using (SqlConnection connection = SqlConnections.AppliCationDBConnection(applicationDBName))
        {
            SqlParameter[] parameters = new SqlParameter[6];
            parameters[0] = new SqlParameter(ConstantsDAL.PARAM_MSGTYPE, MessageType);                    
            parameters[1] = new SqlParameter(ConstantsDAL.PARAM_XMLSWIFTMSGDATA, xmlInboundSwiftData);
            parameters[2] = new SqlParameter(ConstantsDAL.PARAM_USERID, UserId);
            parameters[3] = new SqlParameter(ConstantsDAL.PARAM_SWIFTMESSAGEDATA, xmlSwiftData);
            parameters[4] = new SqlParameter(ConstantsDAL.PARAM_ISSUCCESS, blnSuccess);
            parameters[5] = new SqlParameter(ConstantsDAL.PARAM_FILENAME, ParsedFileName);
            parameters[4].Direction = ParameterDirection.Output;

            DataSet ds = StoredProcSql.ExecuteDataSet(connection, ConstantsDAL.SPNAME_PROCESSINBOUNDSWIFTMESSAGE, parameters);

            if (parameters[4].Value != null)
                blnSuccess = Convert.ToBoolean(parameters[4].Value);

            return ds;
        }
    }
    catch (Exception ex)
    {
        _logger.LogErrorMessage(applicationDBName + " - " + MessageType, "Error in method SaveInboundMessage", ex, true,
                               MethodBase.GetCurrentMethod().Name, new string[] {"Stored Procedure", "ParsedFileName", "UserId" },
                               ConstantsDAL.SPNAME_PROCESSINBOUNDSWIFTMESSAGE, ParsedFileName, UserId);

        throw new Exception(Constants.CONS_METHOD_SAVEINBOUNDMESSAGE); 

    }
}


=> ConstantsDAL.SPNAME_PROCESSINBOUNDSWIFTMESSAGE is an SP p_ProcessInboundSwiftMessage, attaching the exec :


EXEC	@return_value = [dbo].[p_ProcessInboundSwiftMessage]
		@pMsgType = N'MT548',
		@xmlInboundSwiftMessageData = N'<ROOT>
			<record SwiftMessageId="51" RelatedSwiftMsgId="51" SwiftMsgType="548" MessageText="{1:F01STUSUS30AXXX5127500626}{2:O5481518180104STUSUS30AXXX51275090241801041518N}{3:{108:E548180104283331}}{4:
					:16R:GENL
					:20C::SEME//12017072110015O
					:23G:INST
					:16R:LINK
					:20C::RELA//SW49756548
					:16S:LINK
					:16R:STAT
					:25D::MTCH//NMAT
					:16R:REAS
					:24B::NMAT//NCRR
					:70D::REAS//DIFFERENCE IN SETTLEMENT CURRENCY
					:16S:REAS
					:16S:STAT
					:16S:GENL
					:16R:SETTRAN
					:35B:ISIN CA8911452R48
					TORONTO DOMIN BK 2,621  14/21 22/12
					ISIN CA8911452R48
					:36B::SETT//FAMT/160000,
					:19A::SETT//CAD164754,07
					:97A::SAFE//100441021
					:22F::SETR//TRAD
					:22H::REDE//DELI
					:22H::PAYM//APMT
					:98A::TRAD//20171128
					:98A::SETT//20171201
					:16R:SETPRTY
					:95P::REAG//NBFNGB2LXXX
					:16S:SETPRTY
					:16S:SETTRAN
					-}{5:{CHK:264511A2C835}{TNG:}}" MessageDirection="Inbound" MessageStatusId="45" InboundMUR="" InboundReference=""></record>
				</ROOT>',
				@pUserId = N'NPatel',
				@pXMLSwiftMessageData = N'<DocumentElement>
					  <TblTagComp>
						<TagName>16</TagName>
						<Option>R</Option>
						<TagValue>GENL</TagValue>
						<TagCode>16R</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>1</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>20</TagName>
						<Option>C</Option>
						<TagValue>SEME</TagValue>
						<TagCode>20C</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>2</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>20</TagName>
						<Option>C</Option>
						<TagValue>12017072110015O</TagValue>
						<TagCode>20C</TagCode>
						<CompPosition>2</CompPosition>
						<LineNbr>2</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>23</TagName>
						<Option>G</Option>
						<TagValue>INST</TagValue>
						<TagCode>23G</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>3</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>16</TagName>
						<Option>R</Option>
						<TagValue>LINK</TagValue>
						<TagCode>16R</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>4</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>20</TagName>
						<Option>C</Option>
						<TagValue>RELA</TagValue>
						<TagCode>20C</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>5</LineNbr>
					  </TblTagComp>    
					  <TblTagComp>
						<TagName>20</TagName>
						<Option>C</Option>
						<TagValue>SW49756548</TagValue>
						<TagCode>20C</TagCode>
						<CompPosition>2</CompPosition>
						<LineNbr>5</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>16</TagName>
						<Option>S</Option>
						<TagValue>LINK</TagValue>
						<TagCode>16S</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>6</LineNbr>
					  </TblTagComp>  
					 <TblTagComp>
						<TagName>16</TagName>
						<Option>R</Option>
						<TagValue>STAT</TagValue>
						<TagCode>16R</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>7</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>25</TagName>
						<Option>D</Option>
						<TagValue>MTCH</TagValue>
						<TagCode>25D</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>8</LineNbr>
					  </TblTagComp>     
					   <TblTagComp>
						<TagName>25</TagName>
						<Option>D</Option>
						<TagValue>NMAT</TagValue>
						<TagCode>25D</TagCode>
						<CompPosition>2</CompPosition>
						<LineNbr>8</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>16</TagName>
						<Option>R</Option>
						<TagValue>REAS</TagValue>
						<TagCode>16R</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>9</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>24</TagName>
						<Option>B</Option>
						<TagValue>NMAT</TagValue>
						<TagCode>24B</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>10</LineNbr>
					  </TblTagComp>    
					   <TblTagComp>
						<TagName>24</TagName>
						<Option>B</Option>
						<TagValue>NCRR</TagValue>
						<TagCode>24B</TagCode>
						<CompPosition>2</CompPosition>
						<LineNbr>10</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>70</TagName>
						<Option>D</Option>
						<TagValue>REAS</TagValue>
						<TagCode>70D</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>11</LineNbr>
					  </TblTagComp>   
					  <TblTagComp>
						<TagName>70</TagName>
						<Option>D</Option>
						<TagValue>DIFFERENCE IN SETTLEMENT CURRENCY</TagValue>
						<TagCode>70D</TagCode>
						<CompPosition>2</CompPosition>
						<LineNbr>11</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>16</TagName>
						<Option>S</Option>
						<TagValue>REAS</TagValue>
						<TagCode>16S</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>12</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>16</TagName>
						<Option>S</Option>
						<TagValue>STAT</TagValue>
						<TagCode>16S</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>13</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>16</TagName>
						<Option>S</Option>
						<TagValue>GENL</TagValue>
						<TagCode>16S</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>14</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>16</TagName>
						<Option>R</Option>
						<TagValue>SETTRAN</TagValue>
						<TagCode>16R</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>15</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>35</TagName>
						<Option>B</Option>
						<TagValue>ISIN CA8911452R48
					TORONTO DOMIN BK 2,621  14/21 22/12
					ISIN CA8911452R48</TagValue>
						<TagCode>35B</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>16</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>36</TagName>
						<Option>B</Option>
						<TagValue>SETT</TagValue>
						<TagCode>36B</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>19</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>36</TagName>
						<Option>b</Option>
						<TagValue></TagValue>
						<TagCode>36b</TagCode>
						<CompPosition>2</CompPosition>
						<LineNbr>19</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>36</TagName>
						<Option>B</Option>
						<TagValue>FAMT/160000</TagValue>
						<TagCode>36B</TagCode>
						<CompPosition>3</CompPosition>
						<LineNbr>19</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>19</TagName>
						<Option>A</Option>
						<TagValue>SETT</TagValue>
						<TagCode>19A</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>20</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>19</TagName>
						<Option>A</Option>
						<TagValue></TagValue>
						<TagCode>19A</TagCode>
						<CompPosition>2</CompPosition>
						<LineNbr>20</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>19</TagName>
						<Option>A</Option>
						<TagValue>CAD</TagValue>
						<TagCode>19A</TagCode>
						<CompPosition>3</CompPosition>
						<LineNbr>20</LineNbr>
					  </TblTagComp>  
					   <TblTagComp>
						<TagName>19</TagName>
						<Option>A</Option>
						<TagValue>CAD164754,07</TagValue>
						<TagCode>19A</TagCode>
						<CompPosition>4</CompPosition>
						<LineNbr>20</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>97</TagName>
						<Option>A</Option>
						<TagValue>SAFE</TagValue>
						<TagCode>97A</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>21</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>97</TagName>
						<Option>a</Option>
						<TagValue></TagValue>
						<TagCode>971</TagCode>
						<CompPosition>2</CompPosition>
						<LineNbr>21</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>97</TagName>
						<Option>A</Option>
						<TagValue>100441021</TagValue>
						<TagCode>97A</TagCode>
						<CompPosition>3</CompPosition>
						<LineNbr>21</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>22</TagName>
						<Option>F</Option>
						<TagValue>SETR</TagValue>
						<TagCode>22F</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>22</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>22</TagName>
						<Option>F</Option>
						<TagValue></TagValue>
						<TagCode>22F</TagCode>
						<CompPosition>2</CompPosition>
						<LineNbr>22</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>22</TagName>
						<Option>F</Option>
						<TagValue>TRAD</TagValue>
						<TagCode>22F</TagCode>
						<CompPosition>3</CompPosition>
						<LineNbr>22</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>22</TagName>
						<Option>H</Option>
						<TagValue>REDE</TagValue>
						<TagCode>22H</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>23</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>22</TagName>
						<Option>H</Option>
						<TagValue>DELI</TagValue>
						<TagCode>22H</TagCode>
						<CompPosition>2</CompPosition>
						<LineNbr>23</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>22</TagName>
						<Option>H</Option>
						<TagValue>PAYM</TagValue>
						<TagCode>22H</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>24</LineNbr>
					  </TblTagComp>   
					   <TblTagComp>
						<TagName>22</TagName>
						<Option>H</Option>
						<TagValue>APMT</TagValue>
						<TagCode>22H</TagCode>
						<CompPosition>2</CompPosition>
						<LineNbr>24</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>98</TagName>
						<Option>A</Option>
						<TagValue>TRAD</TagValue>
						<TagCode>98A</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>25</LineNbr>
					  </TblTagComp>  
					   <TblTagComp>
						<TagName>98</TagName>
						<Option>A</Option>
						<TagValue>20171128</TagValue>
						<TagCode>98A</TagCode>
						<CompPosition>2</CompPosition>
						<LineNbr>25</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>98</TagName>
						<Option>A</Option>
						<TagValue>SETT</TagValue>
						<TagCode>98A</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>26</LineNbr>
					  </TblTagComp> 
					   <TblTagComp>
						<TagName>98</TagName>
						<Option>A</Option>
						<TagValue>20171201</TagValue>
						<TagCode>98A</TagCode>
						<CompPosition>2</CompPosition>
						<LineNbr>26</LineNbr>
					  </TblTagComp>  
					   <TblTagComp>
						<TagName>16</TagName>
						<Option>R</Option>
						<TagValue>SETPRTY</TagValue>
						<TagCode>16R</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>27</LineNbr>
					  </TblTagComp>
					  <TblTagComp>
						<TagName>95</TagName>
						<Option>P</Option>
						<TagValue>REAG</TagValue>
						<TagCode>95R</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>28</LineNbr>
					  </TblTagComp>  
					  <TblTagComp>
						<TagName>95</TagName>
						<Option>P</Option>
						<TagValue>NBFNGB2LXXX</TagValue>
						<TagCode>95P</TagCode>
						<CompPosition>2</CompPosition>
						<LineNbr>28</LineNbr>
					  </TblTagComp>
					  <TblTagComp>
						<TagName>16</TagName>
						<Option>S</Option>
						<TagValue>SETPRTY</TagValue>
						<TagCode>16S</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>29</LineNbr>
					  </TblTagComp>     
					   <TblTagComp>
						<TagName>16</TagName>
						<Option>S</Option>
						<TagValue>SETTRAN</TagValue>
						<TagCode>16S</TagCode>
						<CompPosition>1</CompPosition>
						<LineNbr>33</LineNbr>
					  </TblTagComp>  
 </DocumentElement>',
				@IsSuccess = @IsSuccess OUTPUT



public class FtpConfigurationElement : ConfigurationElement
{
    #region Configuration Element Definition
    [ConfigurationProperty("destination", IsRequired = true)]
    public string Destination
    {
        get { return (string)this["destination"]; }
        set { this["destination"] = value; }
    }

    [ConfigurationProperty("destinationid", IsRequired = true)]
    public string DestinationId
    {
        get { return (string)this["destinationid"]; }
        set { this["destinationid"] = value; }
    }

    [ConfigurationProperty("server", IsRequired = true)]
    public string Server
    {
        get { return (string)this["server"]; }
        set { this["server"] = value; }
    }

    [ConfigurationProperty("user", IsRequired = true)]
    public string User
    {
        get { return (string)this["user"]; }
        set { this["user"] = value; }
    }

    [ConfigurationProperty("password", IsRequired = true)]
    public string Password
    {
        get { return (string)this["password"]; }
        set { this["password"] = value; }
    }

    [ConfigurationProperty("localarchivalpath", IsRequired = true)]
    public string LocalArchivalPath
    {
        get { return (string)this["localarchivalpath"]; }
        set { this["localarchivalpath"] = value; }
    }

    [ConfigurationProperty("responsepath", IsRequired = true)]
    public string ResponsePath
    {
        get { return (string)this["responsepath"]; }
        set { this["responsepath"] = value; }
    }

    [ConfigurationProperty("inprogresspath", IsRequired = true)]
    public string InprogressPath
    {
        get { return (string)this["inprogresspath"]; }
        set { this["inprogresspath"] = value; }
    }

    [ConfigurationProperty("outboundmsgpath", IsRequired = false)]
    public string OutboundMsgPath
    {
        get { return (string)this["outboundmsgpath"]; }
        set { this["outboundmsgpath"] = value; }
    }

    [ConfigurationProperty("inboundmsgpath", IsRequired = false)]
    public string InboundMsgPath
    {
        get { return (string)this["inboundmsgpath"]; }
        set { this["inboundmsgpath"] = value; }
    }

    [ConfigurationProperty("ackpath", IsRequired = false)]
    public string AckPath
    {
        get { return (string)this["ackpath"]; }
        set { this["ackpath"] = value; }
    }

    [ConfigurationProperty("inboundarchivepath", IsRequired = false)]
    public string InboundArchivePath
    {
        get { return (string)this["inboundarchivepath"]; }
        set { this["inboundarchivepath"] = value; }
    }

    [ConfigurationProperty("responsearchivepath", IsRequired = false)]
    public string ResponseArchivePath
    {
        get { return (string)this["responsearchivepath"]; }
        set { this["responsearchivepath"] = value; }
    }

    [ConfigurationProperty("ackarchivepath", IsRequired = false)]
    public string AckArchivePath
    {
        get { return (string)this["ackarchivepath"]; }
        set { this["ackarchivepath"] = value; }
    }

    [ConfigurationProperty("renamegtxresponse", IsRequired = false)]
    public bool RenameGTXResponse
    {
        get { return (bool)this["renamegtxresponse"]; }
        set { this["renamegtxresponse"] = value; }
    }

    [ConfigurationProperty("renameack", IsRequired = false)]
    public bool RenameAck
    {
        get { return (bool)this["renameack"]; }
        set { this["renameack"] = value; }
    }

    [ConfigurationProperty("renameinboundmsg", IsRequired = false)]
    public bool RenameInboundMsg
    {
        get { return (bool)this["renameinboundmsg"]; }
        set { this["renameinboundmsg"] = value; }
    }

    [ConfigurationProperty("archivegtxresponse", IsRequired = false)]
    public bool ArchiveGTXResponse
    {
        get { return (bool)this["archivegtxresponse"]; }
        set { this["archivegtxresponse"] = value; }
    }

    [ConfigurationProperty("archiveack", IsRequired = false)]
    public bool ArchiveAck
    {
        get { return (bool)this["archiveack"]; }
        set { this["archiveack"] = value; }
    }

    [ConfigurationProperty("archiveinboundmsg", IsRequired = false)]
    public bool ArchiveInboundMsg
    {
        get { return (bool)this["archiveinboundmsg"]; }
        set { this["archiveinboundmsg"] = value; }
    }

    [ConfigurationProperty("deletegtxresponse", IsRequired = false)]
    public bool DeleteGTXResponse
    {
        get { return (bool)this["deletegtxresponse"]; }
        set { this["deletegtxresponse"] = value; }
    }

    [ConfigurationProperty("deleteack", IsRequired = false)]
    public bool DeleteAck
    {
        get { return (bool)this["deleteack"]; }
        set { this["deleteack"] = value; }
    }

    [ConfigurationProperty("deleteinboundmsg", IsRequired = false)]
    public bool DeleteInboundMsg
    {
        get { return (bool)this["deleteinboundmsg"]; }
        set { this["deleteinboundmsg"] = value; }
    }

    [ConfigurationProperty("messagetypes", IsRequired = false)]
    public string MessageTypes
    {
        get { return (string)this["messagetypes"]; }
        set { this["messagetypes"] = value; }
    }

    [ConfigurationProperty("fingerPrint", IsRequired = false)]
    public string FingerPrint
    {
        get { return (string)this["fingerPrint"]; }
        set { this["fingerPrint"] = value; }
    }

    [ConfigurationProperty("privateKeyPath", IsRequired = false)]
    public string PrivateKeyPath
    {
        get { return (string)this["privateKeyPath"]; }
        set { this["privateKeyPath"] = value; }
    }

    [ConfigurationProperty("dbName", IsRequired = true)]
    public string DBName
    {
        get
        {
            return (string)this["dbName"];
        }
        set
        {
            this["dbName"] = value;
        }
    }

    [ConfigurationProperty("outboundMessageInterval", IsRequired = false)]
    public string OutboundMessageInterval
    {
        get
        {
            return (string)this["outboundMessageInterval"];
        }
        set
        {
            this["outboundMessageInterval"] = value;
        }
    }


    [ConfigurationProperty("inboundMessageInterval", IsRequired = false)]
    public string InboundMessageInterval
    {
        get
        {
            return (string)this["inboundMessageInterval"];
        }
        set
        {
            this["inboundMessageInterval"] = value;
        }
    }

    [ConfigurationProperty("gtxMessageInterval", IsRequired = false)]
    public string GTXMessageInterval
    {
        get
        {
            return (string)this["gtxMessageInterval"];
        }
        set
        {
            this["gtxMessageInterval"] = value;
        }
    }

    [ConfigurationProperty("ackMessageInterval", IsRequired = false)]
    public string AckMessageInterval
    {
        get
        {
            return (string)this["ackMessageInterval"];
        }
        set
        {
            this["ackMessageInterval"] = value;
        }
    }

    [ConfigurationProperty("inboundMessageProcessingInterval", IsRequired = false)]
    public string InboundMessageProcessingInterval
    {
        get
        {
            return (string)this["inboundMessageProcessingInterval"];
        }
        set
        {
            this["inboundMessageProcessingInterval"] = value;
        }
    }

    [ConfigurationProperty("processLoanDataInterval", IsRequired = false)]
    public string ProcessLoanDataInterval
    {
        get
        {
            return (string)this["processLoanDataInterval"];
        }
        set
        {
            this["processLoanDataInterval"] = value;
        }
    }

    [ConfigurationProperty("ackResponseSourcePath", IsRequired = false)]
    public string AckResponseSourcePath
    {
        get
        {
            return (string)this["ackResponseSourcePath"];
        }
        set
        {
            this["ackResponseSourcePath"] = value;
        }
    }

    [ConfigurationProperty("outboundTestFileName", IsRequired = false)]
    public string OutboundTestFileName
    {
        get
        {
            return (string)this["outboundTestFileName"];
        }
        set
        {
            this["outboundTestFileName"] = value;
        }
    }
    [ConfigurationProperty("outboundTestFileContent", IsRequired = false)]
    public string OutboundTestFileContent
    {
        get
        {
            return (string)this["outboundTestFileContent"];
        }
        set
        {
            this["outboundTestFileContent"] = value;
        }
    }
    [ConfigurationProperty("isErrorInOutboundFileUpload", IsRequired = false)]
    public string IsErrorInOutboundFileUpload
    {
        get
        {
            return (string)this["isErrorInOutboundFileUpload"];
        }
        set
        {
            this["isErrorInOutboundFileUpload"] = value;
        }
    }

    [ConfigurationProperty("applicationId", IsRequired = false)]
    public string ApplicationId
    {
        get
        {
            return (string)this["applicationId"];
        }
        set
        {
            this["applicationId"] = value;
        }
    }
    [ConfigurationProperty("multipleACKMsgSeperator", IsRequired = false)]
    public string MultipleACKMsgSeperator
    {
        get
        {
            return (string)this["multipleACKMsgSeperator"];
        }
        set
        {
            this["multipleACKMsgSeperator"] = value;
        }
    }
    [ConfigurationProperty("FileName", IsRequired = false)]
    public string FileName
    {
        get
        {
            return (string)this["FileName"];
        }
        set
        {
            this["FileName"] = value;
        }
    }
    [ConfigurationProperty("MessageStatus", IsRequired = false)]
    public string MessageStatus
    {
        get
        {
            return (string)this["MessageStatus"];
        }
        set
        {
            this["MessageStatus"] = value;
        }
    }

    [ConfigurationProperty("isBulkSwiftMessage", IsRequired = false)]
    public string isBulkSwiftMessage
    {
        get
        {
            if (this["isBulkSwiftMessage"] == null || this["isBulkSwiftMessage"].ToString().Trim().Length == 0)
            {
                return "false";
            }
            else
            {
                if (this["isBulkSwiftMessage"].ToString().Trim().ToLower() == "true" || this["isBulkSwiftMessage"].ToString().Trim() == "1")
                    return "true";
                else
                    return "false";
            }
        }
        set
        {
            this["isBulkSwiftMessage"] = value;
        }
    }

    //Mod1
    [ConfigurationProperty("FilterMessgesBasedOnApplicationId", IsRequired = false)]
    public string FilterMessgesBasedOnApplicationId
    {
        get
        {
            if (this["FilterMessgesBasedOnApplicationId"] == null || this["FilterMessgesBasedOnApplicationId"].ToString().Trim().Length == 0)
            {
                return "false";
            }
            else
            {
                if (this["FilterMessgesBasedOnApplicationId"].ToString().Trim().ToLower() == "true" || this["FilterMessgesBasedOnApplicationId"].ToString().Trim() == "1")
                    return "true";
                else
                    return "false";
            }
        }
        set
        {
            this["FilterMessgesBasedOnApplicationId"] = value;
        }
    }
    #endregion
}
