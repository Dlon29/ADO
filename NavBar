public async Task ConsumeMessagesAsync(CancellationToken ct)
{
    try
    {
        foreach (var mqMessage in _swiftInboundMQSubscriber.ReadMessages(ct))
        {
            try
            {
                var swiftMessages =
                    _swiftInboundFactory.ReadSwiftMessages(
                        mqMessage.Payload,
                        mqMessage.CorrelationId,
                        _tagCompData,
                        _ftpConfigurationElement);

                foreach (var swiftMessage in swiftMessages)
                {
                    var entity = MapToSwiftInboundMQ(swiftMessage);
                    await _swiftInboundRepository.AddAsync(entity, ct);
                }
            }
            catch (Exception ex)
            {
                _logger.LogError(
                    ex,
                    "Error processing MQ message. CorrelationId: {CorrelationId}",
                    mqMessage.CorrelationId
                );
            }
        }
    }
    catch (Exception ex)
    {
        _logger.LogError(ex, "Error while consuming MQ messages.");
    }
}


    public InboundSwiftMessageCollection ReadSwiftMessagesFromMQ(
string mqPayload,
string correlationId,
string tagCompData,
FtpConfigurationElement item)
    {
        List<string> lstMessages = new();
        List<KeyValuePair<string, string>> lstMessageFilename = new();

        ApplicationHeaderBlock applicationHeader =
            new ApplicationHeaderBlock(mqPayload);

        string[] filterMessageType =
            (item.MessageTypes.Replace(Constants.CONS_MESSAGETYPESTART, ""))
            .Split('|');

        if (!filterMessageType.Contains(applicationHeader.MessageType))
            return new InboundSwiftMessageCollection();

        lstMessages.Add(mqPayload);
        lstMessageFilename.Add(
            new KeyValuePair<string, string>(correlationId, mqPayload));

        // Parsing only â€“ no DB call
        return new InboundSwiftMessageCollection(
            lstMessages,
            tagCompData,
            lstMessageFilename);
    }
